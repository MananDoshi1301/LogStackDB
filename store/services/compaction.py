def compaction(self) -> None:
  # buffer in reverse
  # if key not in set let it be
  # else remove
  ...